<html>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Binance Trade Calculator - Daohoangdhh</title>
<head>


    <style>
        body{
            background: rgb(0, 0, 0);
            color: white;
        }
        .header{
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            padding: 15px;
            display: block;
            
        }
        .headtext{

        }
        .trigia{
            text-align: center;
    min-height: 50px;
    display: flex;
    width: 100%;
        }
        .trigia #showgiavnd{
    flex: 1;
    text-align: center;
    font-size: 25px;
    padding: 10px;
    font-weight: bold;
    color: #6cff72;
    align-self: center;
        }
        .trigia .showtigia{
            align-self: center;
        }
        
        input{
    font-size: 16px;
    font-weight: bold;
        }
        input.inputgia{
            width: 60px;
            border: 0px solid greenyellow;
            background: greenyellow;
        }
        input.inputbe{
            width: 35px;
        }
        input.inputvua{
            width: 60px;
        }
        #showgiamua{
            padding:15px;
            border:1px solid green;
        }
        table{
            width: 100%;
            border: 1px solid white;
        }
        table tr td.head{
            font-size:11px;
            font-weight: bold;
        }
        table .showgia{
            font-size:20px;
            font-weight: bold;
            min-height:30px;
        }
        table.giaban tr td{
            border:1px solid rgb(75, 75, 75);
            width:25%;
            color: #31ff31;
        }
        table.giaban.catlo tr td{
            color: #da9fff;

        }
        table tr td.middle{
            text-align: center;
        }
        table tr td.end{
            text-align: right;
        }
        .textbold{
            font-weight: bold;
            font-size: 13px;
        }
        .headline{
            font-weight: bold;
            font-size: 13px;
        }
        .red{
            background: #dd0808;
        }
        .green{
            background: #007605;
        }
        .holdethprice{
            display: flex;
            width: 100%;
            min-height: 50px;
            justify-content: center;
        }
        #ethprice{
            font-weight: bold;
            font-size: 25px;
            text-align: center;
            padding:10px;
            display: inline-block;
        }
        #giamuonban{
            display: none;
        }
        #giamuonban2{
            width: 60px;
            padding: 5px;
            margin-top: 15px;
        }
        .sauheadtext{
            padding:10px 0;
        }
        #livecal tr td, #livecal2 tr td{
            width: 30%;
        }
    </style>
</head>

<body>

    <div class="header">BINANCE STOCK TRADE</div>
    <div class="headtext">
    Tài sản <input type="number" class="inputvua" id="taisandangco" value="getCookie('taisandangco')">
    Giá mua vào <input type="number" class="inputgia" id="giamua">

    </div>
 <div class="sauheadtext">
    Tỉ giá: <input type="number" class="inputvua" id="tigia" value="22680">
    Sell Fee <input id="phigiamuonban" type="number" value="0.1" class="inputbe">
    Buy Fee <input id="phibanra" class="inputbe" type="number" value="0.1"></td>
 </div>
   
</div>
    
    
    <table>
        <tr>
            <td><span class="textbold">TAKE PROFIT  </span><input id="dutinhban" type="number" value="1" class="inputbe"> Stop Loss <input id="dutinhcatlo" type="number" value="0.8" class="inputbe">
        </td>
            </tr>
        <tr>
            <td>
                <table class="giaban">
                    <tr>
                        <td class="head">GIÁ BÁN</td>
                        <td class="head middle">TÀI SẢN</td>
                        <td class="head middle">LÃI $</td>
                        <td class="head end">LÃI VNĐ</td>
                    </tr>
                    <tr>
                        <td><div id="giadutinhban" class="showgia"></div></td>
                        <td class="middle"><div id="trigiasauban" class="showgia"></div></td>
                        <td class="middle"><div id="loinhuansauban" class="showgia"></div></td>
                        <td class="end"><div id="loinhuanvnd" class="showgia"></div></td>
    
                    </tr>
                </table>
                
    
            </td>
            </tr>
            <tr>
                <td class="headline">STOP LOSS</td>
            </tr>
            <tr>
                <td>
                    <table class="giaban catlo">
                        <tr>
                            <td class="head">GIÁ BÁN</td>
                            <td class="head middle">TÀI SẢN</td>
                            <td class="head middle">LỖ</td>
                            <td class="head end">LỖ VNĐ</td>
                        </tr>
                       <tr>
                        <td><div id="giacatlo" class="showgia"></div></td>
                        <td class="middle"><div id="trigiasaucatlo" class="showgia"></div></td>
                        <td class="middle"><div id="thiethai" class="showgia"></div></td>
                        <td class="end"><div id="thiethaivnd" class="showgia"></div></td>
                       </tr>
                    </table>
                </td>
    
        </tr>
    </table>
    <div class="holdethprice">
        <div id="ethprice"></div>
    </div>

</div>
 <input id="giamuonban" type="number" value="1" class="giamuonban">
    
    <table id="livecal">
    <tr>
        <td class="head">Value</td>
       <td class="head middle">Profit %</td>
       <td class="head end">Profit $</td>
    </tr>
    <tr>
        <td><div id="chenhlechgiaban" class="showgia"></div></td>
        <td class="middle"><div id="loinhuangiamuonbanphantram" class="showgia"></div></td>
        <td class="end"><div id="loinhuangiamuonban" class="showgia"></div></td>
      
    </tr>
  
    <tr>
        <td class="head">Total</td>
        <td class="head middle">Profit VND</td>
        <td class="head end">Total VND</td>
        </tr>
        <tr>
            <td><div id="tongtaisansaumuonban" class="showgia"></div></td>
            <td class="middle"><div id="loinhuangiamuonbanvnd" class="showgia"></div></td>
            <td class="end"><div id="tongtaisansaumuonbanvnd" class="showgia"></div></td>       
    </tr>
    </table>
    




    <input id="giamuonban2" type="number" value="1" class="giamuonban">


    <table id="livecal2">
        <tr>
            <td class="head">Value</td>
           <td class="head middle">Profit %</td>
           <td class="head end">Profit $</td>
        </tr>
        <tr>
            <td><div id="chenhlechgiaban2" class="showgia"></div></td>
            <td class="middle"><div id="loinhuangiamuonbanphantram2" class="showgia"></div></td>
            <td class="end"><div id="loinhuangiamuonban2" class="showgia"></div></td>
          
        </tr>
      
        <tr>
            <td class="head">Total</td>
            <td class="head middle">Profit VND</td>
            <td class="head end">Total VND</td>
            </tr>
            <tr>
                <td><div id="tongtaisansaumuonban2" class="showgia"></div></td>
                <td class="middle"><div id="loinhuangiamuonbanvnd2" class="showgia"></div></td>
                <td class="end"><div id="tongtaisansaumuonbanvnd2" class="showgia"></div></td>       
        </tr>
        </table>
        
    
    
    <script>
       function numberWithCommas(x) {
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
    function dutinhban(){
        
                     //gia du tinh ban ra
        var taisan = document.getElementById("taisandangco").valueAsNumber;   
                            setCookie('taisan', taisan, '365');
        
        var tigia = document.getElementById("tigia").valueAsNumber;   
                    setCookie('tigia',tigia, '365');
        
        var phibanra = document.getElementById("phibanra").valueAsNumber;   
        
        var giamua = document.getElementById("giamua").valueAsNumber;
                     setCookie('giamua', giamua, '365'); /// if input sotien
        var dtbrval = document.getElementById("dutinhban").valueAsNumber;
        var dtbr = giamua + (giamua * dtbrval/100);
        document.getElementById('giadutinhban').innerHTML = dtbr.toFixed(2);
    
        var trigiasauban = taisan + (taisan * dtbrval/100) - (taisan *phibanra/100);
        document.getElementById('trigiasauban').innerHTML = trigiasauban.toFixed(2);
        var loinhuansauban = trigiasauban - taisan;
        document.getElementById('loinhuansauban').innerHTML = loinhuansauban.toFixed(2);
        var loinhuanvnd = loinhuansauban * tigia;
        document.getElementById('loinhuanvnd').innerHTML = numberWithCommas(loinhuanvnd.toFixed());
    
        
        
        
                      // gia du tinh cat lo
        var dtclval = document.getElementById("dutinhcatlo").valueAsNumber;
        var dtcl = giamua + (giamua * -dtclval/100);
        document.getElementById('giacatlo').innerHTML = dtcl.toFixed(2);
    
        var trigiasaucatlo = taisan - (taisan * dtclval/100) - (taisan * phibanra/100);
        document.getElementById('trigiasaucatlo').innerHTML = trigiasaucatlo.toFixed(2);
        var thiethai = taisan - trigiasaucatlo;
        document.getElementById('thiethai').innerHTML = thiethai.toFixed(2);
        var thiethaivnd = thiethai * tigia;
        document.getElementById('thiethaivnd').innerHTML = numberWithCommas(thiethaivnd.toFixed());
    
    
    
    }
    function livecal(){

        var taisan = document.getElementById("taisandangco").valueAsNumber;   
        var giamua = document.getElementById("giamua").valueAsNumber;
        var tigia = document.getElementById("tigia").valueAsNumber;   


        var giamuonban = document.getElementById("giamuonban").valueAsNumber;
        var phigiamuonban = document.getElementById("phigiamuonban").valueAsNumber;
        var chenhlechgiaban = giamuonban - giamua;
        document.getElementById('chenhlechgiaban').innerHTML = chenhlechgiaban.toFixed(2);
        var loinhuangiamuonbanphantram = (chenhlechgiaban/giamua) * 100 - phigiamuonban;
        if (loinhuangiamuonbanphantram > 0){
            document.getElementById("livecal").className = "green";
        }
        if (loinhuangiamuonbanphantram < 0){
            document.getElementById("livecal").className = "red";
        }


        document.getElementById('loinhuangiamuonbanphantram').innerHTML = loinhuangiamuonbanphantram.toFixed(2) + '<span class="percent">%</span>';
        var loinhuangiamuonban = taisan * loinhuangiamuonbanphantram/100;
        document.getElementById('loinhuangiamuonban').innerHTML = loinhuangiamuonban.toFixed(2);
        var loinhuangiamuonbanvnd = loinhuangiamuonban * tigia;
        document.getElementById('loinhuangiamuonbanvnd').innerHTML = numberWithCommas(loinhuangiamuonbanvnd.toFixed());
        var tongtaisansaumuonban = taisan + loinhuangiamuonban;
        document.getElementById('tongtaisansaumuonban').innerHTML = tongtaisansaumuonban.toFixed(2);
        var tongtaisansaumuonbanvnd = tongtaisansaumuonban * tigia;
        document.getElementById('tongtaisansaumuonbanvnd').innerHTML = numberWithCommas(tongtaisansaumuonbanvnd.toFixed());

    }
    
    function nhapban(){

var taisan = document.getElementById("taisandangco").valueAsNumber;   
var giamua = document.getElementById("giamua").valueAsNumber;
var tigia = document.getElementById("tigia").valueAsNumber;   


var giamuonban = document.getElementById("giamuonban2").valueAsNumber;
var phigiamuonban = document.getElementById("phigiamuonban").valueAsNumber;
var chenhlechgiaban = giamuonban - giamua;
document.getElementById('chenhlechgiaban2').innerHTML = chenhlechgiaban.toFixed(2);
var loinhuangiamuonbanphantram = (chenhlechgiaban/giamua) * 100 - phigiamuonban;
if (loinhuangiamuonbanphantram > 0){
    document.getElementById("livecal2").className = "green";
}
if (loinhuangiamuonbanphantram < 0){
    document.getElementById("livecal2").className = "red";
}


document.getElementById('loinhuangiamuonbanphantram2').innerHTML = loinhuangiamuonbanphantram.toFixed(2) + '<span class="percent">%</span>';
var loinhuangiamuonban = taisan * loinhuangiamuonbanphantram/100;
document.getElementById('loinhuangiamuonban2').innerHTML = loinhuangiamuonban.toFixed(2);
var loinhuangiamuonbanvnd = loinhuangiamuonban * tigia;
document.getElementById('loinhuangiamuonbanvnd2').innerHTML = numberWithCommas(loinhuangiamuonbanvnd.toFixed());
var tongtaisansaumuonban = taisan + loinhuangiamuonban;
document.getElementById('tongtaisansaumuonban2').innerHTML = tongtaisansaumuonban.toFixed(2);
var tongtaisansaumuonbanvnd = tongtaisansaumuonban * tigia;
document.getElementById('tongtaisansaumuonbanvnd2').innerHTML = numberWithCommas(tongtaisansaumuonbanvnd.toFixed());

}

        
        
        function setCookie(cname, cvalue, exdays) {
  const d = new Date();
  d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
  let expires = "expires="+d.toUTCString();
  document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
  let name = cname + "=";
  let ca = document.cookie.split(';');
  for(let i = 0; i < ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}


document.addEventListener("DOMContentLoaded", function(event) { 
document.getElementById("giamua").value = getCookie('giamua');
document.getElementById("tigia").value = getCookie('tigia');
document.getElementById("taisandangco").value = getCookie('taisandangco');
    console.log(getCookie('giamua'));
     console.log(getCookie('tigia'));
     console.log(getCookie('taisandangco'));
});

    document.getElementById("giamua").addEventListener("input", dutinhban); /// if input sotien
    document.getElementById("taisandangco").addEventListener("input", dutinhban); /// if input sotien
    document.getElementById("giamuonban2").addEventListener("input", nhapban); /// if input sotien

    </script>
<script>
    let etherprice = document.getElementById("ethprice");
    let giamuonban = document.getElementById("giamuonban");
    let ws = new WebSocket('wss://stream.binance.com:9443/ws/ethusdt@trade')
    let lastPrice = null;

    ws.onmessage = (event) => {
        let stockObject = JSON.parse(event.data);
        let ethval = stockObject.p;
        let price = parseFloat(ethval).toFixed(2);

        etherprice.innerHTML = price;   
        if (price > lastPrice){
            etherprice.className = "green";
        }
        if (price < lastPrice){
            etherprice.className = "red";
        }
        lastPrice = price;

        giamuonban.value = ethval;
        livecal();
    }
</script>
</body>
</html>
